{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rule Details - Yara Search</title>
    <!-- Include Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Include Font Awesome for icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet" />
    <!-- Include your custom CSS -->
    <link href="{% static 'css/style.css' %}" rel="stylesheet" type="text/css" />
    <style>
      /* Custom styles for copy button */
      .copy-btn {
        margin-top: 10px;
      }
    </style>
  </head>
  <body>
    <div class="container my-5 position-relative">
      <!-- Add position-relative to the container -->
      <!-- Home icon -->
      <button type="button" class="home-icon" onclick="navigateToHome()">
        <i class="fas fa-arrow-left"></i>
        <!-- Left arrow icon -->
      </button>

      <h1 class="main-title text-center mb-4">Yara Search</h1>
      <p class="section-subtitle text-center mb-4">Rule Details</p>

      <!-- Rule Details Container -->
      <div class="card p-4 shadow-lg">
        <!-- Rule Title -->
        <h2 class="rule-title">{{ rule.title }}</h2>

        <!-- Rule Information -->
        <div class="rule-info mt-4">
          <h4>Rule Information</h4>
          <hr class="mb-3" />
          <p><strong>Description:</strong> {{ rule.description }}</p>
          {% if rule.reference %}
          <p><strong>Reference:</strong> <a href="{{ rule.reference }}" target="_blank">{{ rule.reference }}</a></p>
          {% endif %} {% if rule.additional_info %}
          <p><strong>Additional Notes:</strong> {{ rule.additional_info }}</p>
          {% endif %}
        </div>

        <!-- Rule Display -->
        <div class="rule-display">
          <h4>The Rule</h4>
          <hr class="" />
          <div class="d-flex align-items-center">
            <pre id="ruleText" class="bg-light p-3 rounded flex-grow-1">{{ rule.rule_text }}</pre>
            <button class="btn btn-secondary copy-btn ml-2" onclick="copyToClipboard()" aria-label="Copy to clipboard">
              <i class="fas fa-clipboard"></i>
            </button>
          </div>
        </div>

        <!-- Additional Details -->
        <div class="additional-details mt-4">
          <h4>Additional Details</h4>
          <hr class="mb-3" />
          <p><strong>Author:</strong> {{ rule.author }}</p>
          {% if rule.tags %}
          <p><strong>Tags:</strong> {{ rule.tags }}</p>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Include your custom JS -->
    <script src="{% static 'Javascript/javascript.js' %}"></script>
    <!-- Include Bootstrap JS for interactivity -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
